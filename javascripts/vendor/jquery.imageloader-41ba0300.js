!function(e){"use strict";var n,t={selector:"",dataattr:"src",background:!1,each:null,eacherror:null,callback:null,timeout:5e3},a=function(n,a,c){var d,l=u.getInstance(),s=e(a),f=e.extend({},t,c||{}),h="_"+(""+(new Date).valueOf()).slice(-7),g=0;return""===f.selector&&s.data(f.dataattr)?(d=s,g=1):(d=s.find([f.selector,"[data-",f.dataattr,"]"].join("")),g=d.length),s.data(h,{each:f.each,eacherror:f.eacherror,callback:f.callback,isLoading:!0,loadedImageCounter:0,length:g}),0===g?o(a,h):(d.each(function(e,n){l.add(i(n,a,h,f.background,f.dataattr,f.timeout))}),s.on("loadImage."+h,r),l.run()),a},r=function(n,t,a,r){var i=n.currentTarget,u=e(i).data(n.namespace);u.isLoading&&(r?"function"==typeof u.eacherror&&u.eacherror(t):"function"==typeof u.each&&u.each(t,a),++u.loadedImageCounter,u.loadedImageCounter>=u.length&&o(i,n.namespace))},o=function(n,t){var a=e(n),o=a.data(),i=o[t].callback;a.off("loadImage."+t,r),delete o[t],"function"==typeof i&&setTimeout(function(){i(n)},2*e.imageloader.queueInterval)},i=function(n,t,a,r,o,i){var u=e(n),c=u.data(o),d=!1,l=function(r,i){u.removeAttr(["data-",o].join("")),e(t).triggerHandler("loadImage."+a,[n,i,r&&"error"===r.type])};return function(){var n,t=e("<img />");t.bind("error",function(t){d=!0,clearTimeout(n),e(this).unbind("error").unbind("load"),l(t)}).bind("load",function(a){d=!0,clearTimeout(n),e(this).unbind("error").unbind("load"),r?u.css("background-image",["url(",c,")"].join("")):u.attr("src",c),l(a,t[0])}).attr("src",c),n=setTimeout(function(){d===!1&&t.trigger("error")},i)}},u={getInstance:function(){return n instanceof c==!1&&(n=new c),n}},c=function(){this.index=0,this.queue=[],this.isRunning=!1};c.prototype.add=function(e){if("function"!=typeof e)throw new Error("you can only pass function.");this.queue.push(e)},c.prototype.run=function(n){var t=e.proxy(this.run,this);n=n||!1,(!this.isRunning||n)&&(this.isRunning=!0,this.queue[this.index++](),this.index<this.queue.length?setTimeout(function(){t(!0)},e.imageloader.queueInterval):this.isRunning=!1)},e.imageloader={queueInterval:17},e.fn.imageloader=function(e){return this.each(function(n,t){a(n,t,e)})}}(jQuery);